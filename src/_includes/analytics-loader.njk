<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

// Default EU-safe state
gtag('consent','default',{
  ad_storage:'denied',
  analytics_storage:'denied',
  wait_for_update:500
});

// expose helper so consent.js can activate analytics later
window.enableAnalytics = function() {

  if (window.__gaLoaded) return;
  window.__gaLoaded = true;

  const s = document.createElement("script");
  s.async = true;
  s.src = "https://www.googletagmanager.com/gtag/js?id={{ site.gaId }}";
  document.head.appendChild(s);

  gtag('js', new Date());
  gtag('config', '{{ site.gaId }}', {
    anonymize_ip: true
  });
};
</script>
